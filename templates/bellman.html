{% extends "base.html" %}

{% block head %}
Bellman's Cafe
{% endblock %}

{% block body %}
<h1>Welcome to Bellman's Cafe</h1>
<form action="#" method="post">
    <p>Enter an exercice:</p>
    <p><input type="text" name="ex" placeholder = "For example: 1+2*3" /></p>

    <p><label for="gra">Choose Grammar:</label>

<select id="grammarselect" onchange=myFunction(this) name="gra" id="gra">
  <option value="">Choose a grammar</option>
  <script type=text/javascript>
    var grafiles = {{ grafiles|safe }};
    grafiles.forEach(function(element) {
        let grammar = element.substring(0, element.lastIndexOf('.')) || element;
        document.write('<option value="'+grammar+'">'+grammar+'</option>');
    });
  </script>
</select>
<script type=text/javascript>
    function myFunction(selectObject) {
        var dictionary = {{ dictionary|safe }};
        var selected = selectObject.value;
        
        if(selected == ""){
          var alg2Select = document.getElementById("alg2select");
            while (alg2Select.firstChild) {
                alg2Select.removeChild(alg2Select.firstChild);
            } 
            var operat = document.getElementById("operator")
            operat.selectedIndex = 0;
        }
        
        var algebrasList = dictionary[selected];
        
        var alg1Select = document.getElementById("alg1select");
        while (alg1Select.firstChild) {
            alg1Select.removeChild(alg1Select.firstChild);
        }
        algebrasList.forEach(function(algebraString) {
            var option = document.createElement("option");
            option.value = algebraString;
            option.text = algebraString;
            alg1Select.appendChild(option);
        });
    }
</script>
</p>

    <p><label for="alg1">Choose Algebra 1:</label>

<select id="alg1select" name="alg1" id="alg1">
</select>
</p>

<p><label for="operator">Algebra Produkt:</label>

<select name="operator" id="operator" onchange=otherFunction(this)>
  <option value=""></option>
  <option value="*">*</option>
  <option value="X">X</option>
  <option value="Y">Y</option>
</select>
<script type=text/javascript>
    function otherFunction(selectObject) {
        
        var dictionary = {{ dictionary|safe }};
        
        var selectObj = document.getElementById("grammarselect");
        var selected = selectObj.value;
        
        var alg2Select = document.getElementById("alg2select");
        while (alg2Select.firstChild) {
            alg2Select.removeChild(alg2Select.firstChild);
        }
        var emptyOption = document.createElement("option");
        emptyOption.value = "";
        emptyOption.text = "";
        alg2Select.appendChild(emptyOption);
        
        algebrasList = dictionary[selected];
        
        algebrasList.forEach(function(algebraString) {
            var option = document.createElement("option");
            option.value = algebraString;
            option.text = algebraString;
            alg2Select.appendChild(option);
        });
    }
</script>
</p>


<p><label for="alg2">Choose Algebra 2:</label>

<select id="alg2select" name="alg2" id="alg2">
<option value=""></option>
</select>
</p>


<p><button type="submit" id=submit>Submit</button></p>
</form>


{% endblock %}
